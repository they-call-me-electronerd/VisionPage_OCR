# PageVision OCR - System Architecture

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERACTION                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Press 'S'â”‚  â”‚ Press 'T'â”‚  â”‚ Press 'A'â”‚  â”‚ Press 'Q'â”‚       â”‚
â”‚  â”‚  Speak   â”‚  â”‚   Save   â”‚  â”‚  Toggle  â”‚  â”‚   Quit   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          MAIN.PY                                 â”‚
â”‚                    (Application Controller)                      â”‚
â”‚                                                                   â”‚
â”‚  â€¢ Initializes all components                                    â”‚
â”‚  â€¢ Manages application flow                                      â”‚
â”‚  â€¢ Handles user input                                            â”‚
â”‚  â€¢ Coordinates between modules                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼              â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CAMERA     â”‚ â”‚ PREPROCESS   â”‚ â”‚     OCR      â”‚ â”‚    SPEECH    â”‚
â”‚   MODULE     â”‚ â”‚   MODULE     â”‚ â”‚   ENGINE     â”‚ â”‚    MODULE    â”‚
â”‚              â”‚ â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
â”‚ â€¢ Capture    â”‚ â”‚ â€¢ Grayscale  â”‚ â”‚ â€¢ Extract    â”‚ â”‚ â€¢ Convert    â”‚
â”‚   frames     â”‚ â”‚ â€¢ Blur       â”‚ â”‚   text       â”‚ â”‚   to speech  â”‚
â”‚ â€¢ Set res.   â”‚ â”‚ â€¢ CLAHE      â”‚ â”‚ â€¢ Draw boxes â”‚ â”‚ â€¢ Adjust     â”‚
â”‚ â€¢ Release    â”‚ â”‚ â€¢ Threshold  â”‚ â”‚ â€¢ Filter     â”‚ â”‚   rate/vol   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                           â–¼
                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                    â”‚  FILE        â”‚
                                                    â”‚  HANDLER     â”‚
                                                    â”‚              â”‚
                                                    â”‚ â€¢ Save text  â”‚
                                                    â”‚ â€¢ Append     â”‚
                                                    â”‚ â€¢ List files â”‚
                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Processing Pipeline

```
1. CAPTURE           2. PREPROCESS         3. OCR              4. SPEECH
   â†“                    â†“                    â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Webcam  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Image   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚Tesseractâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ TTS     â”‚
â”‚ Frame   â”‚  RGB    â”‚Enhance  â”‚ Binary  â”‚Extract  â”‚  Text   â”‚ Engine  â”‚
â”‚1280x720 â”‚         â”‚Pipeline â”‚  Image  â”‚  Text   â”‚         â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                    â”‚                   â”‚
                         â”‚                    â”‚                   â”‚
                         â–¼                    â–¼                   â–¼
                    Display with          Save to            Play Audio
                    Bounding Boxes        File (opt)         (Speaker)
```

## ğŸ—ï¸ Module Dependencies

```
main.py
  â”œâ”€â”€ camera/
  â”‚   â””â”€â”€ camera.py
  â”‚       â””â”€â”€ cv2 (OpenCV)
  â”‚
  â”œâ”€â”€ preprocess/
  â”‚   â””â”€â”€ preprocess.py
  â”‚       â”œâ”€â”€ cv2 (OpenCV)
  â”‚       â””â”€â”€ numpy
  â”‚
  â”œâ”€â”€ ocr/
  â”‚   â””â”€â”€ ocr_engine.py
  â”‚       â”œâ”€â”€ pytesseract
  â”‚       â”œâ”€â”€ cv2 (OpenCV)
  â”‚       â””â”€â”€ numpy
  â”‚
  â”œâ”€â”€ speech/
  â”‚   â””â”€â”€ text_to_speech.py
  â”‚       â”œâ”€â”€ pyttsx3
  â”‚       â””â”€â”€ threading
  â”‚
  â””â”€â”€ utils/
      â””â”€â”€ file_handler.py
          â”œâ”€â”€ os
          â””â”€â”€ datetime
```

## âš™ï¸ Component Interaction

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PageVisionOCR                          â”‚
â”‚                    (Main Controller)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Camera  â”‚â”€â”€â”€â–¶â”‚ Preprocessor â”‚â”€â”€â”€â–¶â”‚   OCR    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚                                     â”‚              â”‚
â”‚       â”‚                                     â–¼              â”‚
â”‚       â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚       â”‚                            â”‚ Text Compare â”‚       â”‚
â”‚       â”‚                            â”‚(New/Duplicate)â”‚      â”‚
â”‚       â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚       â”‚                                     â”‚              â”‚
â”‚       â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚       â”‚              â”‚                      â”‚         â”‚   â”‚
â”‚       â–¼              â–¼                      â–¼         â–¼   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Display  â”‚  â”‚  Boxes   â”‚          â”‚   TTS   â”‚ â”‚Save â”‚â”‚
â”‚  â”‚  Frame   â”‚  â”‚  Overlay â”‚          â”‚ Speak   â”‚ â”‚File â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Real-time Processing Loop

```
START APPLICATION
      â”‚
      â–¼
Initialize Components
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Main Loop       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (While Running) â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Read Camera Frame                 â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Is Frame Valid? â”€â”€Noâ”€â”€â–¶ Continue â”€â”¤
      â”‚                           â”‚
     Yes                          â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Increment Frame Counter           â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Is OCR Interval? â”€â”€Noâ”€â”€â–¶ Display â”€â”¤
      â”‚                           â”‚
     Yes                          â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Preprocess Image                  â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Extract Text (OCR)                â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Is New Text? â”€â”€Noâ”€â”€â–¶ Display â”€â”€â”€â”€â”¤
      â”‚                           â”‚
     Yes                          â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Auto-Speak? â”€â”€Yesâ”€â”€â–¶ Speak Text  â”‚
      â”‚                           â”‚
      No                          â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Display Frame                     â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Handle Keyboard? â”€â”€Noâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚                           â”‚
     Yes                          â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Execute Command                   â”‚
      â”‚                           â”‚
      â–¼                           â”‚
Quit? â”€â”€Noâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
     Yes
      â–¼
Cleanup & Exit
      â”‚
      â–¼
    END
```

## ğŸ“¦ Class Hierarchy

```
Camera
â”œâ”€â”€ __init__(camera_index, width, height)
â”œâ”€â”€ start()
â”œâ”€â”€ read_frame()
â”œâ”€â”€ release()
â””â”€â”€ is_opened()

ImagePreprocessor
â”œâ”€â”€ __init__()
â”œâ”€â”€ preprocess(frame)
â”œâ”€â”€ denoise(image)
â”œâ”€â”€ deskew(image)
â””â”€â”€ get_preprocessed_for_display(frame)

OCREngine
â”œâ”€â”€ __init__(language, confidence_threshold)
â”œâ”€â”€ extract_text(image)
â”œâ”€â”€ extract_text_with_boxes(image)
â”œâ”€â”€ clean_text(text)
â”œâ”€â”€ is_new_text(current_text)
â”œâ”€â”€ calculate_similarity(text1, text2)
â”œâ”€â”€ draw_boxes(frame, boxes)
â””â”€â”€ set_language(language)

TextToSpeech
â”œâ”€â”€ __init__(rate, volume)
â”œâ”€â”€ configure_engine()
â”œâ”€â”€ speak(text, blocking)
â”œâ”€â”€ stop()
â”œâ”€â”€ set_rate(rate)
â”œâ”€â”€ set_volume(volume)
â”œâ”€â”€ list_voices()
â””â”€â”€ set_voice(voice_index)

FileHandler
â”œâ”€â”€ __init__(output_dir)
â”œâ”€â”€ create_output_directory()
â”œâ”€â”€ save_text(text, filename)
â”œâ”€â”€ append_text(text, filename)
â”œâ”€â”€ save_image(image, filename)
â”œâ”€â”€ read_text(filename)
â””â”€â”€ list_saved_files()

PageVisionOCR (Main Controller)
â”œâ”€â”€ __init__()
â”œâ”€â”€ display_instructions()
â”œâ”€â”€ add_overlay_text(...)
â”œâ”€â”€ create_info_panel(frame)
â”œâ”€â”€ process_frame(frame)
â”œâ”€â”€ run()
â””â”€â”€ cleanup()
```

## ğŸ” Security Considerations

- âœ… No network communication (fully offline)
- âœ… Local file storage only
- âœ… No external API calls
- âœ… Camera access requires user permission
- âœ… File operations in designated directory

## âš¡ Performance Optimization

1. **Frame Skip**: OCR every 15th frame (configurable)
2. **Non-blocking TTS**: Speech in background thread
3. **Smart Caching**: Avoid re-speaking identical text
4. **Efficient Preprocessing**: Optimized OpenCV operations
5. **Lazy Loading**: Components initialized on demand

---

**Architecture designed for: Modularity | Scalability | Maintainability**
